function cov_28m3gtk6hm(){var path="C:\\Users\\euler\\OneDrive\\\u684C\u9762\\3813\\week4\\server\\router\\postLogin.js";var hash="5f5ab17c26bc7bf03d904f138ebf83ebd86398d5";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\euler\\OneDrive\\\u684C\u9762\\3813\\week4\\server\\router\\postLogin.js",statementMap:{"0":{start:{line:2,column:0},end:{line:30,column:2}},"1":{start:{line:3,column:4},end:{line:29,column:7}},"2":{start:{line:4,column:8},end:{line:4,column:31}},"3":{start:{line:5,column:8},end:{line:7,column:11}},"4":{start:{line:6,column:12},end:{line:6,column:39}},"5":{start:{line:8,column:18},end:{line:8,column:32}},"6":{start:{line:9,column:18},end:{line:9,column:30}},"7":{start:{line:10,column:19},end:{line:10,column:82}},"8":{start:{line:11,column:12},end:{line:25,column:13}},"9":{start:{line:12,column:16},end:{line:22,column:19}},"10":{start:{line:24,column:16},end:{line:24,column:43}},"11":{start:{line:27,column:8},end:{line:27,column:23}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:2,column:17},end:{line:2,column:18}},loc:{start:{line:2,column:44},end:{line:30,column:1}},line:2},"1":{name:"(anonymous_1)",decl:{start:{line:3,column:23},end:{line:3,column:24}},loc:{start:{line:3,column:48},end:{line:29,column:5}},line:3}},branchMap:{"0":{loc:{start:{line:5,column:8},end:{line:7,column:11}},type:"if",locations:[{start:{line:5,column:8},end:{line:7,column:11}},{start:{line:5,column:8},end:{line:7,column:11}}],line:5},"1":{loc:{start:{line:11,column:12},end:{line:25,column:13}},type:"if",locations:[{start:{line:11,column:12},end:{line:25,column:13}},{start:{line:11,column:12},end:{line:25,column:13}}],line:11}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"5f5ab17c26bc7bf03d904f138ebf83ebd86398d5"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_28m3gtk6hm=function(){return actualCoverage;};}return actualCoverage;}cov_28m3gtk6hm();cov_28m3gtk6hm().s[0]++;module.exports=function(db,app,client){cov_28m3gtk6hm().f[0]++;cov_28m3gtk6hm().s[1]++;app.post('/login',async function(req,res){cov_28m3gtk6hm().f[1]++;cov_28m3gtk6hm().s[2]++;await client.connect();cov_28m3gtk6hm().s[3]++;if(!req.body){cov_28m3gtk6hm().b[0][0]++;cov_28m3gtk6hm().s[4]++;return res.sendStatus(400);}else{cov_28m3gtk6hm().b[0][1]++;}const u=(cov_28m3gtk6hm().s[5]++,req.body.email);const p=(cov_28m3gtk6hm().s[6]++,req.body.pwd);let user=(cov_28m3gtk6hm().s[7]++,await db.collection('users').findOne({email:u,password:p}));cov_28m3gtk6hm().s[8]++;if(user){cov_28m3gtk6hm().b[1][0]++;cov_28m3gtk6hm().s[9]++;res.send({valid:true,user:{userid:user.userid,username:user.username,roles:user.roles,groups:user.groups,email:user.email,filename:user.filename}});}else{cov_28m3gtk6hm().b[1][1]++;cov_28m3gtk6hm().s[10]++;res.send({valid:false});}cov_28m3gtk6hm().s[11]++;client.close();});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMjhtM2d0azZobSIsImFjdHVhbENvdmVyYWdlIiwicyIsIm1vZHVsZSIsImV4cG9ydHMiLCJkYiIsImFwcCIsImNsaWVudCIsImYiLCJwb3N0IiwicmVxIiwicmVzIiwiY29ubmVjdCIsImJvZHkiLCJiIiwic2VuZFN0YXR1cyIsInUiLCJlbWFpbCIsInAiLCJwd2QiLCJ1c2VyIiwiY29sbGVjdGlvbiIsImZpbmRPbmUiLCJwYXNzd29yZCIsInNlbmQiLCJ2YWxpZCIsInVzZXJpZCIsInVzZXJuYW1lIiwicm9sZXMiLCJncm91cHMiLCJmaWxlbmFtZSIsImNsb3NlIl0sInNvdXJjZXMiOlsicG9zdExvZ2luLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlxyXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGRiLCBhcHAsIGNsaWVudCApIHtcclxuICAgIGFwcC5wb3N0KCcvbG9naW4nLCBhc3luYyBmdW5jdGlvbihyZXEsIHJlcykge1xyXG4gICAgICAgIGF3YWl0IGNsaWVudC5jb25uZWN0KCk7XHJcbiAgICAgICAgaWYgKCFyZXEuYm9keSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAwKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICBjb25zdCB1ID0gcmVxLmJvZHkuZW1haWw7XHJcbiAgICAgICAgY29uc3QgcCA9IHJlcS5ib2R5LnB3ZDtcclxuICAgICAgICBsZXQgdXNlciA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oJ3VzZXJzJykuZmluZE9uZSh7IGVtYWlsOiB1LCBwYXNzd29yZDogcCB9KVxyXG4gICAgICAgICAgICBpZiAodXNlcikge1xyXG4gICAgICAgICAgICAgICAgcmVzLnNlbmQoe1xyXG4gICAgICAgICAgICAgICAgICAgIHZhbGlkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcmlkOiB1c2VyLnVzZXJpZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXIudXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvbGVzOiB1c2VyLnJvbGVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cHM6IHVzZXIuZ3JvdXBzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6dXNlci5maWxlbmFtZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmVzLnNlbmQoeyB2YWxpZDogZmFsc2UgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xpZW50LmNsb3NlKCk7XHJcblxyXG4gICAgfSk7XHJcbn07XHJcbiJdLCJtYXBwaW5ncyI6InFpRUFlWTtBQUFBQSxjQUFBLFNBQUFBLENBQUEsU0FBQUMsY0FBQSxXQUFBQSxjQUFBLEVBQUFELGNBQUEsR0FBQUEsY0FBQSxHQUFBRSxDQUFBLE1BZFpDLE1BQU0sQ0FBQ0MsT0FBTyxDQUFHLFNBQVNDLEVBQUUsQ0FBRUMsR0FBRyxDQUFFQyxNQUFNLENBQUcsQ0FBQVAsY0FBQSxHQUFBUSxDQUFBLE1BQUFSLGNBQUEsR0FBQUUsQ0FBQSxNQUN4Q0ksR0FBRyxDQUFDRyxJQUFJLENBQUMsUUFBUSxDQUFFLGVBQWVDLEdBQUcsQ0FBRUMsR0FBRyxDQUFFLENBQUFYLGNBQUEsR0FBQVEsQ0FBQSxNQUFBUixjQUFBLEdBQUFFLENBQUEsTUFDeEMsS0FBTSxDQUFBSyxNQUFNLENBQUNLLE9BQU8sQ0FBQyxDQUFDLENBQUNaLGNBQUEsR0FBQUUsQ0FBQSxNQUN2QixHQUFJLENBQUNRLEdBQUcsQ0FBQ0csSUFBSSxDQUFFLENBQUFiLGNBQUEsR0FBQWMsQ0FBQSxTQUFBZCxjQUFBLEdBQUFFLENBQUEsTUFDWCxNQUFPLENBQUFTLEdBQUcsQ0FBQ0ksVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUM1QixDQUFDLEtBQUFmLGNBQUEsR0FBQWMsQ0FBQSxVQUNILEtBQU0sQ0FBQUUsQ0FBQyxFQUFBaEIsY0FBQSxHQUFBRSxDQUFBLE1BQUdRLEdBQUcsQ0FBQ0csSUFBSSxDQUFDSSxLQUFLLEVBQ3hCLEtBQU0sQ0FBQUMsQ0FBQyxFQUFBbEIsY0FBQSxHQUFBRSxDQUFBLE1BQUdRLEdBQUcsQ0FBQ0csSUFBSSxDQUFDTSxHQUFHLEVBQ3RCLEdBQUksQ0FBQUMsSUFBSSxFQUFBcEIsY0FBQSxHQUFBRSxDQUFBLE1BQUcsS0FBTSxDQUFBRyxFQUFFLENBQUNnQixVQUFVLENBQUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sQ0FBQyxDQUFFTCxLQUFLLENBQUVELENBQUMsQ0FBRU8sUUFBUSxDQUFFTCxDQUFFLENBQUMsQ0FBQyxFQUFBbEIsY0FBQSxHQUFBRSxDQUFBLE1BQ3RFLEdBQUlrQixJQUFJLENBQUUsQ0FBQXBCLGNBQUEsR0FBQWMsQ0FBQSxTQUFBZCxjQUFBLEdBQUFFLENBQUEsTUFDTlMsR0FBRyxDQUFDYSxJQUFJLENBQUMsQ0FDTEMsS0FBSyxDQUFFLElBQUksQ0FDWEwsSUFBSSxDQUFFLENBQ0ZNLE1BQU0sQ0FBRU4sSUFBSSxDQUFDTSxNQUFNLENBQ25CQyxRQUFRLENBQUVQLElBQUksQ0FBQ08sUUFBUSxDQUN2QkMsS0FBSyxDQUFFUixJQUFJLENBQUNRLEtBQUssQ0FDakJDLE1BQU0sQ0FBRVQsSUFBSSxDQUFDUyxNQUFNLENBQ25CWixLQUFLLENBQUVHLElBQUksQ0FBQ0gsS0FBSyxDQUNqQmEsUUFBUSxDQUFDVixJQUFJLENBQUNVLFFBQ2xCLENBQ0osQ0FBQyxDQUFDLENBQ04sQ0FBQyxJQUFNLENBQUE5QixjQUFBLEdBQUFjLENBQUEsU0FBQWQsY0FBQSxHQUFBRSxDQUFBLE9BQ0hTLEdBQUcsQ0FBQ2EsSUFBSSxDQUFDLENBQUVDLEtBQUssQ0FBRSxLQUFNLENBQUMsQ0FBQyxDQUM5QixDQUFDekIsY0FBQSxHQUFBRSxDQUFBLE9BRUxLLE1BQU0sQ0FBQ3dCLEtBQUssQ0FBQyxDQUFDLENBRWxCLENBQUMsQ0FBQyxDQUNOLENBQUMifQ==